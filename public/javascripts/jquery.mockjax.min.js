/*!
 * MockJax - jQuery Plugin to Mock Ajax requests
 *
 * Version:  1.3.3
 * Released: 2010-11-05
 * Source:   http://github.com/appendto/jquery-mockjax
 * Docs:     http://enterprisejquery.com/2010/07/mock-your-ajax-requests-with-mockjax-for-rapid-development
 * Plugin:   mockjax
 * Author:   Jonathan Sharp (http://jdsharp.com)
 * License:  MIT,GPL
 * 
 * Copyright (c) 2010 appendTo LLC.
 * Dual licensed under the MIT or GPL licenses.
 * http://appendto.com/open-source-licenses
 */
(function(c){var n=c.ajax,h=[];c.extend({ajax:function(g){var a=jQuery.extend(true,{},jQuery.ajaxSettings,g),m=false;c.each(h,function(i){if(h[i]){var b=null;if(c.isFunction(h[i]))b=h[i](a);else{b=h[i];if(c.isFunction(b.url.test))b.url.test(a.url)||(b=null);else{i=b.url.indexOf("*");if(b.url!="*"&&b.url!=a.url&&i==-1||i>-1&&b.url.substr(0,i)!=a.url.substr(0,i))b=null}if(b){if(b.data&&a.data){var l=false;(function d(e,k){if(typeof k==="string")return l=c.isFunction(e.test)?e.test(k):e==k;c.each(e,
function(j){if(k[j]===undefined)return l=false;else{l=true;if(typeof k[j]=="object")return d(e[j],k[j]);else return l=c.isFunction(e[j].test)?e[j].test(k[j]):e[j]==k[j]}})})(b.data,a.data);if(l==false)b=null}if(b&&b.type&&b.type!=a.type)b=null}}if(b){typeof console!=="undefined"&&console.log&&console.log("MOCK GET: "+a.url);m=true;if(a.dataType==="jsonp"){if(a.type.toUpperCase()==="GET")f.test(a.url)||(a.url+=(rquery.test(a.url)?"&":"?")+(a.jsonp||"callback")+"=?");else if(!a.data||!f.test(a.data))a.data=
(a.data?a.data+"&":"")+(a.jsonp||"callback")+"=?";a.dataType="json"}var f=/=\?(&|$)/;if(a.dataType==="json"&&(a.data&&f.test(a.data)||f.test(a.url))){jsonp=a.jsonpCallback||"jsonp"+jsc++;if(a.data)a.data=(a.data+"").replace(f,"="+jsonp+"$1");a.url=a.url.replace(f,"="+jsonp+"$1");a.dataType="script";window[jsonp]=window[jsonp]||function(d){data=d;o();p();window[jsonp]=undefined;try{delete window[jsonp]}catch(e){}head&&head.removeChild(script)}}f=(f=/^(\w+:)?\/\/([^\/?#]+)/.exec(a.url))&&(f[1]&&f[1]!==
location.protocol||f[2]!==location.host);if(a.dataType==="script"&&a.type.toUpperCase()==="GET"&&f){var q=g&&g.context||a,o=function(){if(a.success)a.success.call(q,b.response?b.response.toString():b.responseText||"",status,{});if(a.global){var d=[{},a];(a.context?jQuery(a.context):jQuery.event).trigger("ajaxSuccess",d)}},p=function(){a.complete&&a.complete.call(q,{},status);if(a.global){var d=[{},a];(a.context?jQuery(a.context):jQuery.event).trigger("ajaxComplete",d)}a.global&&!--jQuery.active&&
jQuery.event.trigger("ajaxStop")};b.response&&c.isFunction(b.response)?b.response(g):c.globalEval(b.responseText);o();p();return false}m=n.call(c,c.extend(true,{},g,{xhr:function(){b=c.extend({},c.mockjaxSettings,b);return{status:b.status,readyState:1,open:function(){},send:function(){var d=c.proxy(function(){this.status=b.status;this.readyState=4;c.isFunction(b.response)&&b.response(g);if(a.dataType=="json"&&typeof b.responseText=="object")this.responseText=JSON.stringify(b.responseText);else if(a.dataType==
"xml")this.responseXML=c.xmlDOM&&typeof b.responseXML=="string"?c.xmlDOM(b.responseXML)[0]:b.responseXML;else this.responseText=b.responseText;this.onreadystatechange(b.isTimeout?"timeout":undefined)},this);if(b.proxy)n({global:false,url:b.proxy,type:b.type,data:b.data,dataType:a.dataType,complete:function(e){b.responseXML=e.responseXML;b.responseText=e.responseText;this.responseTimer=setTimeout(d,b.responseTime||0)}});else if(a.async===false)d();else this.responseTimer=setTimeout(d,b.responseTime||
50)},abort:function(){clearTimeout(this.responseTimer)},setRequestHeader:function(){},getResponseHeader:function(d){if(b.headers&&b.headers[d])return b.headers[d];else if(d=="Last-modified")return b.lastModified||(new Date).toString();else if(d=="Etag")return b.etag||"";else if(d=="content-type")return b.contentType||"text/plain"}}}}));return false}}});return m?m:n.apply(c,arguments)}});c.mockjaxSettings={status:200,responseTime:500,isTimeout:false,contentType:"text/plain",response:"",responseText:"",
responseXML:"",proxy:"",lastModified:null,etag:"",headers:{etag:"IJF@H#@923uf8023hFO@I#H#","content-type":"text/plain"}};c.mockjax=function(g){var a=h.length;h[a]=g;return a};c.mockjaxClear=function(g){if(arguments.length==1)h[g]=null;else h=[]}})(jQuery);